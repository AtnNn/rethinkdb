Issue
  { issueClosedAt = Just 2015 (-01) (-20) 19 : 58 : 21 UTC
  , issueUpdatedAt = 2015 (-01) (-23) 21 : 46 : 53 UTC
  , issueEventsUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/3609/events"
  , issueHtmlUrl =
      Just "https://github.com/rethinkdb/rethinkdb/issues/3609"
  , issueClosedBy = Nothing
  , issueLabels = []
  , issueNumber = 3609
  , issueAssignee =
      Just
        SimpleUser
          { simpleUserId = Id 7431361
          , simpleUserLogin = N "larkost"
          , simpleUserAvatarUrl =
              "https://avatars.githubusercontent.com/u/7431361?v=3"
          , simpleUserUrl = "https://api.github.com/users/larkost"
          , simpleUserType = OwnerUser
          }
  , issueUser =
      SimpleUser
        { simpleUserId = Id 17789
        , simpleUserLogin = N "gchpaco"
        , simpleUserAvatarUrl =
            "https://avatars.githubusercontent.com/u/17789?v=3"
        , simpleUserUrl = "https://api.github.com/users/gchpaco"
        , simpleUserType = OwnerUser
        }
  , issueTitle = "Test failures in ReQL tests on `next` on MacOS X"
  , issuePullRequest = Nothing
  , issueUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/3609"
  , issueCreatedAt = 2015 (-01) (-20) 02 : 36 : 58 UTC
  , issueBody =
      Just
        "I've been experiencing these failures for some time on OS X, and folks bugged me to open an issue about it.\n\n```\n$ ./test-runner connections/connection.js connections/http.js connections/connection.py2.6 connections/http.rb2.0 server_test.rb2.0\nUsing rethinkdb binary /Users/graham/wd/rethinkdb/build/debug_clang/rethinkdb\n    javascript interpreter: /usr/local/bin/node, driver: /Users/graham/wd/rethinkdb/drivers/javascript\n    python 2.6 interpreter: /usr/bin/python2.6, driver: /Users/graham/wd/rethinkdb/drivers/python\n    ruby 2.0 interpreter: /usr/bin/ruby, driver: /Users/graham/wd/rethinkdb/drivers/ruby\n== Starting: connections/connection.js (T+ 0.9 sec)\n== Starting: connections/connection.py2.6 (T+ 1.0 sec)\n>>> Failed connections/connection.js with exit code 2 after 5.5 sec (T+ 6.6 sec)\n\nUsing RethinkDB client from: /Users/graham/wd/rethinkdb/build/packages/js\n\n\n  Javascript connection API\n    \10003 times out with a server that doesn't do the handshake correctly (1008ms)\n    With no server\n      1) fails when trying to connect\n      \10003 empty run\nRethinkDB warning: This syntax is deprecated. Please use `run(connection[, options      \10003 run with an object\n    With a server\n      2) \"before each\" hook\n\n\n  3 passing (5s)\n  2 failing\n\n  1) Javascript connection API With no server fails when trying to connect:\n     Error: timeout of 2000ms exceeded\n      at null.<anonymous> (/Users/graham/node_modules/mocha/lib/runnable.js:157:19)\n      at Timer.listOnTimeout [as ontimeout] (timers.js:112:15)\n\n  2) Javascript connection API With a server \"before each\" hook:\n     Error: timeout of 2000ms exceeded\n      at null.<anonymous> (/Users/graham/node_modules/mocha/lib/runnable.js:157:19)\n      at Timer.listOnTimeout [as ontimeout] (timers.js:112:15)\n\n\n\n\n<<< end Failed: connections/connection.js\n== Starting: connections/http.js (T+ 7.1 sec)\n>>> Failed connections/http.js with exit code 1 after 2.2 sec (T+ 9.4 sec)\n\n/usr/local/lib/python2.7/site-packages/twisted/internet/_sslverify.py:184: UserWarning: You do not have the service_identity module installed. Please install it from <https://pypi.python.org/pypi/service_identity>. Without the service_identity module and a recent enough pyOpenSSL tosupport it, Twisted can perform only rudimentary TLS client hostnameverification.  Many valid certificate/hostname mappings may be rejected.\n  verifyHostname, VerificationError = _selectVerifyImplementation()\nUsing RethinkDB client from: /Users/graham/wd/rethinkdb/build/packages/js\n\n\n  Javascript HTTP test -\n    GET\n      \10003 check basic GET result\n    params\n      \10003 with null\n      \10003 with existing url params\n    header\n      \10003 object\n      \10003 array\n    HEAD\n      \10003 with text resultFormat\n      \10003 with json resultFormat\n    POST\n      \10003 form-encoded object\n      \10003 json object\n      \10003 form-encoded string\n      \10003 arbitrary string\n    PUT\n      \10003 object\n      \10003 arbitrary string\n    PATCH\n      \10003 object\n      \10003 arbitrary string\n    DELETE\n      \10003 object\n      \10003 arbitrary string\n    redirect\n      \10003 with no redirects allowed\n      \10003 with not enough redirects allowed\n      \10003 with enough redirects allowed\n    gzip\n      \10003 check decompression\n    errors -\n      \10003 failed json parse\n    basic auth\n      \10003 wrong password\n      \10003 wrong username\n      \10003 wrong auth type\n      \10003 correct credentials\n      \10003 default auth type\n    digest auth\n      \10003 wrong password\n      \10003 wrong username\n      \10003 wrong auth type\n      \10003 correct credentials\n    verify\n      \10003 HTTP (74ms)\nAssertionError: Expected an error, but got nullAssertionError: Expected an error, but got null\n    at expect_error (/Users/graham/wd/rethinkdb/test/rql_test/connections/http.js:48:5)\n    at /Users/graham/wd/rethinkdb/test/rql_test/connections/http.js:396:17\n    at tryCatch2 (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/util.js:51:21)\n    at Function.Promise$_successAdapter (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/nodeify.js:47:11)\n    at tryCatch1 (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/util.js:43:21)\n    at Promise$_callHandler [as _callHandler] (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/promise.js:649:13)\n    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler] (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/promise.js:663:18)\n    at Promise$_settlePromiseAt [as _settlePromiseAt] (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/promise.js:826:14)\n    at Promise$_settlePromises [as _settlePromises] (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/promise.js:969:14)\n    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/async.js:75:12)\n    at Async$consumeFunctionBuffer (/Users/graham/wd/rethinkdb/build/packages/js/node_modules/bluebird/js/main/async.js:38:14)\n    at process._tickCallback (node.js:442:13)\n\n<<< end Failed: connections/http.js\n== Starting: connections/http.rb2.0 (T+ 10.0 sec)\n>>> Failed connections/http.rb2.0 with exit code 1 after 2.2 sec (T+ 12.3 sec)\n\n/usr/local/lib/python2.7/site-packages/twisted/internet/_sslverify.py:184: UserWarning: You do not have the service_identity module installed. Please install it from <https://pypi.python.org/pypi/service_identity>. Without the service_identity module and a recent enough pyOpenSSL tosupport it, Twisted can perform only rudimentary TLS client hostnameverification.  Many valid certificate/hostname mappings may be rejected.\n  verifyHostname, VerificationError = _selectVerifyImplementation()\n/Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:39:in `expect_error': Expected an error, but got success with result:  (RuntimeError)\n    from /Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:226:in `test_part'\n    from /Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:234:in `test_verify'\n    from /Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:269:in `call'\n    from /Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:269:in `block in <main>'\n    from /Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:267:in `each'\n    from /Users/graham/wd/rethinkdb/test/rql_test/connections/http.rb:267:in `<main>'\nRethinkDB Driver Port: 64861\nRunning test test_get\n - PASS\nRunning test test_params\n - PASS\nRunning test test_headers\n - PASS\nRunning test test_head\n - PASS\nRunning test test_post\n - PASS\nRunning test test_put\n - PASS\nRunning test test_patch\n - PASS\nRunning test test_delete\n - PASS\nRunning test test_redirects\n - PASS\nRunning test test_gzip\n - PASS\nRunning test test_failed_json_parse\n - PASS\nRunning test test_basic_auth\n - PASS\nRunning test test_digest_auth\n - PASS\nRunning test test_verify\n\n<<< end Failed: connections/http.rb2.0\n== Starting: server_test.rb2.0 (T+ 12.9 sec)\n>>> Failed server_test.rb2.0 with exit code 1 after 15.7 sec (T+ 28.8 sec)\n\nRun options:\n\n# Running tests:\n\n...F\n\nFinished tests in 15.253228s, 0.2622 tests/s, 18.4879 assertions/s.\n\n  1) Failure:\ntest_malformed_queries(ClientTest) [/Users/graham/wd/rethinkdb/test/rql_test/server_test.rb:133]:\n<{\"t\"=>16, \"b\"=>[], \"r\"=>[\"Protocol error, connection closed.\"]}> expected but was\n<{\"t\"=>16, \"r\"=>[\"Client is buggy (failed to deserialize query).\"], \"b\"=>[]}>.\n\n4 tests, 282 assertions, 1 failures, 0 errors, 0 skips\n\nruby -v: ruby 2.0.0p481 (2014-05-08 revision 45883) [universal.x86_64-darwin14]\n\n<<< end Failed: server_test.rb2.0\n>>> Failed connections/connection.py2.6 with exit code 1 after 74.4 sec (T+ 75.5 sec)\n\ntest_auth_key (__main__.TestNoConnection) ... Not testing default port ok\ntest_connect (__main__.TestNoConnection) ... Not testing default port ok\ntest_connect_host (__main__.TestNoConnection) ... ok\ntest_connect_port (__main__.TestNoConnection) ... ok\nTest that we get a ReQL error if we connect to a non-responsive port ... FAIL\ntest_empty_run (__main__.TestNoConnection) ... ok\ntest_connect_correct_auth (__main__.TestAuthConnection) ... ok\ntest_connect_long_auth (__main__.TestAuthConnection) ... ok\ntest_connect_no_auth (__main__.TestAuthConnection) ... ok\ntest_connect_wrong_auth (__main__.TestAuthConnection) ... ok\ntest_close_does_not_wait_if_requested (__main__.TestConnection) ... ok\ntest_close_waits_by_default (__main__.TestConnection) ... ok\ntest_connect_close_expr (__main__.TestConnection) ... ok\ntest_connect_close_reconnect (__main__.TestConnection) ... ok\ntest_db (__main__.TestConnection) ... ok\ntest_noreply_wait_waits (__main__.TestConnection) ... ok\ntest_port_conversion (__main__.TestConnection) ... ok\ntest_reconnect_does_not_wait_if_requested (__main__.TestConnection) ... ok\ntest_reconnect_waits_by_default (__main__.TestConnection) ... ok\ntest_repl (__main__.TestConnection) ... ok\ntest_use_outdated (__main__.TestConnection) ... ok\nrunTest (__main__.TestPrinting) ... ok\nrunTest (__main__.TestBatching) ... ok\nrunTest (__main__.TestGetIntersectingBatching) ... Running py connection tests\nRandom seed: 11340336524665664616 ok\nrunTest (__main__.TestGroupWithTimeKey) ... ok\nrunTest (__main__.TestSuccessAtomFeed) ... ok\ntest_shutdown (__main__.TestShutdown) ... ok\n\n======================================================================\nFAIL: Test that we get a ReQL error if we connect to a non-responsive port\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/graham/wd/rethinkdb/test/rql_test/connections/connection.py\", line 170, in test_connnect_timeout\n    self.assertRaisesRegexp(r.RqlDriverError, \"Timed out during handshake with localhost:%d.\" % port, r.connect, port=port, timeout=2)\n  File \"/Users/graham/wd/rethinkdb/test/rql_test/connections/connection.py\", line 99, in replacement_assertRaisesRegexp\n    self.assertTrue(re.search(regexp, str(e)), '%s did not raise the expected message \"%s\", but rather: %s' % (repr(callable_func), str(regexp), str(e)))\nAssertionError: <function connect at 0x101bf37d0> did not raise the expected message \"Timed out during handshake with localhost:64673.\", but rather: Interrupted connection while receiving from localhost:64673 - timed out\n\n----------------------------------------------------------------------\nRan 27 tests in 73.181s\n\nFAILED (failures=1)\n\n<<< end Failed: connections/connection.py2.6\n\n== Failed 5 tests (of 5) in 76.31 seconds!\n    connections/connection.js\n    connections/http.js\n    connections/http.rb2.0\n    server_test.rb2.0\n    connections/connection.py2.6\n```\n"
  , issueState = "closed"
  , issueId = Id 54836880
  , issueComments = 1
  , issueMilestone =
      Just
        Milestone
          { milestoneCreator =
              SimpleUser
                { simpleUserId = Id 706854
                , simpleUserLogin = N "AtnNn"
                , simpleUserAvatarUrl =
                    "https://avatars.githubusercontent.com/u/706854?v=3"
                , simpleUserUrl = "https://api.github.com/users/AtnNn"
                , simpleUserType = OwnerUser
                }
          , milestoneDueOn = Nothing
          , milestoneOpenIssues = 1
          , milestoneNumber = 17
          , milestoneClosedIssues = 595
          , milestoneDescription =
              Just
                "The scope of this issue is covered by another issue. The closing comment should link to the other issue."
          , milestoneTitle = "duplicate"
          , milestoneUrl =
              "https://api.github.com/repos/rethinkdb/rethinkdb/milestones/17"
          , milestoneCreatedAt = 2013 (-03) (-29) 20 : 23 : 12 UTC
          , milestoneState = "closed"
          }
  }