IssueComment
  { issueCommentUpdatedAt = 2015 (-10) (-21) 20 : 10 : 28 UTC
  , issueCommentUser =
      SimpleUser
        { simpleUserId = Id 552910
        , simpleUserLogin = N "Tryneus"
        , simpleUserAvatarUrl =
            "https://avatars.githubusercontent.com/u/552910?v=3"
        , simpleUserUrl = "https://api.github.com/users/Tryneus"
        , simpleUserType = OwnerUser
        }
  , issueCommentUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/comments/150011213"
  , issueCommentHtmlUrl =
      "https://github.com/rethinkdb/rethinkdb/issues/4972#issuecomment-150011213"
  , issueCommentCreatedAt = 2015 (-10) (-21) 20 : 10 : 28 UTC
  , issueCommentBody =
      "I got one of these on the `v2.1.x` build last night (a007331), core file and server files available on newton in `~grey/issue_4972_2/`.\r\n\r\nBacktrace from gdb:\r\n\r\n```cpp\r\n#0  0x0000000001604ba5 in linux_thread_pool_t::fatal_signal_handler (signum=11, info=0x7fb00903e570, data=0x7fb00903e440)\r\n        at ../src/arch/runtime/thread_pool.cc:359\r\n#1  <signal handler called>\r\n#2  0x00000000019017b5 in operator() (this=0x7fafe9d63860, sub=0x7fb009217800)\r\n        at ../src/rdb_protocol/changefeed.cc:2306\r\n#3  0x000000000191deae in std::_Function_handler<void(ql::changefeed::range_sub_t*), ql::changefeed::msg_visitor_t::operator()(const ql::changefeed::msg_t::change_t&) const::<lambda(ql::changefeed::range_sub_t*)> >::_M_invoke(const std::_Any_data &, ql::changefeed::range_sub_t *) (__functor=..., __args#0=0x7fb009217800)\r\n        at /usr/include/c++/4.6/functional:1778\r\n#4  0x0000000001931cfb in std::function<void(ql::changefeed::range_sub_t*)>::operator()(ql::changefeed::range_sub_t *) const (this=0x7faff6d84e90, __args#0=0x7fb009217800)\r\n        at /usr/include/c++/4.6/functional:2161\r\n#5  0x000000000191fc36 in ql::changefeed::feed_t::each_sub_in_vec_cb<ql::changefeed::range_sub_t>(const std::function<void(ql::changefeed::range_sub_t*)> &, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > &, const std::vector<int, std::allocator<int> > &, int) (this=0x7fafe2bfcf00, f=..., vec=std::vector of length 25, capacity 25 = {...}, subscription_threads=std::vector of length 1, capacity 1 = {...}, i=0)\r\n        at ../src/rdb_protocol/changefeed.cc:2932\r\n#6  0x00000000019555bb in std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > >&, const std::vector<int, std::allocator<int> >&, int)>::operator()(ql::changefeed::feed_t *, const std::function<void(ql::changefeed::range_sub_t*)> &, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > &, const std::vector<int, std::allocator<int> > &, int) const (this=0x7faff6d84800, __object=0x7fafe2bfcf00, __args#0=..., __args#1=std::vector of length 25, capacity 25 = {...}, __args#2=std::vector of length 1, capacity 1 = {...}, __args#3=0)\r\n        at /usr/include/c++/4.6/functional:551\r\n#7  0x000000000194fb4b in std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > >&, const std::vector<int, std::allocator<int> >&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > >, std::reference_wrapper<const std::vector<int, std::allocator<int> > >, std::_Placeholder<1>)>::__call_c<void, long&, 0, 1, 2, 3, 4>(std::tuple<long&> &, std::_Index_tuple<0, 1, 2, 3, 4>) const (this=0x7faff6d84800, __args=empty std::tuple)\r\n        at /usr/include/c++/4.6/functional:1155\r\n#8  0x0000000001948a71 in std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > >&, const std::vector<int, std::allocator<int> >&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > >, std::reference_wrapper<const std::vector<int, std::allocator<int> > >, std::_Placeholder<1>)>::operator()<long int&, void>(void) const (this=0x7faff6d84800)\r\n        at /usr/include/c++/4.6/functional:1219\r\n#9  0x000000000193f2e3 in pmap_runner_one_arg_t<std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > >&, const std::vector<int, std::allocator<int> >&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > >, std::reference_wrapper<const std::vector<int, std::allocator<int> > >, std::_Placeholder<1>)>, long int>::operator()(void) (this=0x7faff6d84750)\r\n        at ../src/concurrency/pmap.hpp:20\r\n#10 0x0000000001931fbd in pmap<std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*> >&, const std::vector<int>&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*> > >, std::reference_wrapper<const std::vector<int> >, std::_Placeholder<1>)> >(int64_t, int64_t, const std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > >&, const std::vector<int, std::allocator<int> >&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > >, std::reference_wrapper<const std::vector<int, std::allocator<int> > >, std::_Placeholder<1>)> &) (begin=0, end=1, c=...)\r\n        at ../src/concurrency/pmap.hpp:47\r\n#11 0x000000000191fd8e in pmap<std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*> >&, const std::vector<int>&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*> > >, std::reference_wrapper<const std::vector<int> >, std::_Placeholder<1>)> >(int64_t, const std::_Bind<std::_Mem_fn<void (ql::changefeed::feed_t::*)(const std::function<void(ql::changefeed::range_sub_t*)>&, const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > >&, const std::vector<int, std::allocator<int> >&, int)>(ql::changefeed::feed_t*, std::reference_wrapper<const std::function<void(ql::changefeed::range_sub_t*)> >, std::reference_wrapper<const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > >, std::reference_wrapper<const std::vector<int, std::allocator<int> > >, std::_Placeholder<1>)> &) (count=1, c=...)\r\n        at ../src/concurrency/pmap.hpp:53\r\n#12 0x00000000019106f0 in ql::changefeed::feed_t::each_sub_in_vec<ql::changefeed::range_sub_t>(const std::vector<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> >, std::allocator<std::set<ql::changefeed::range_sub_t*, std::less<ql::changefeed::range_sub_t*>, std::allocator<ql::changefeed::range_sub_t*> > > > &, rwlock_in_line_t *, const auto_drainer_t::lock_t &, const std::function<void(ql::changefeed::range_sub_t*)> &) (this=0x7fafe2bfcf00, vec=std::vector of length 25, capacity 25 = {...}, spot=0x7faff6d848f0, lock=..., f=...)\r\n        at ../src/rdb_protocol/changefeed.cc:2915\r\n#13 0x00000000018f386e in ql::changefeed::feed_t::each_range_sub(const auto_drainer_t::lock_t &, const std::function<void(ql::changefeed::range_sub_t*)> &) (this=0x7fafe2bfcf00, lock=..., f=...)\r\n        at ../src/rdb_protocol/changefeed.cc:2941\r\n#14 0x0000000001902d5d in ql::changefeed::msg_visitor_t::operator() (this=0x7faff6d85380, change=...)\r\n        at ../src/rdb_protocol/changefeed.cc:2392\r\n#15 0x0000000001958f9b in boost::detail::variant::invoke_visitor<ql::changefeed::msg_visitor_t>::internal_visit<ql::changefeed::msg_t::change_t const> (this=0x7faff6d85120, operand=...)\r\n        at /usr/local/include/boost/variant/variant.hpp:858\r\n...\r\n```\r\n\r\nThis is on the same `sub->active()` call that I got from the last backtrace on `next`, and inspection of the `sub` object once again shows corruption of some kind.  The segfault is probably due to following the corrupted vtable pointer."
  , issueCommentId = 150011213
  }