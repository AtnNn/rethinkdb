IssueComment
  { issueCommentUpdatedAt = 2014 (-09) (-24) 03 : 51 : 51 UTC
  , issueCommentUser =
      SimpleUser
        { simpleUserId = Id 525534
        , simpleUserLogin = N "timjrobinson"
        , simpleUserAvatarUrl =
            "https://avatars.githubusercontent.com/u/525534?v=3"
        , simpleUserUrl = "https://api.github.com/users/timjrobinson"
        , simpleUserType = OwnerUser
        }
  , issueCommentUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/comments/56621888"
  , issueCommentHtmlUrl =
      "https://github.com/rethinkdb/rethinkdb/issues/3077#issuecomment-56621888"
  , issueCommentCreatedAt = 2014 (-09) (-24) 03 : 51 : 51 UTC
  , issueCommentBody =
      "Thanks for looking into this guys. When you mentioned the versions I went and checked all servers and all are running:\r\n```\r\nrethinkdb 1.14.1-0ubuntu1~trusty (GCC 4.8.2)\r\n```\r\nThey were originally running 1.14.0 but I upgraded them a day or two after the patch came out. I didn't migrate any data when upgrading, just shut them down, upgraded, and rebooted. \r\n\r\nAlso all my instances are created using the puppet rethinkdb module. And for some reason it starts 2 rethinkdb processes on each machine. I'm not sure if this is normal or not. Here's what ps ax gives me:\r\n\r\n```\r\nroot@db-2:~# ps ax | grep rethinkdb\r\n15735 ?        Ssl  1163:30 /usr/bin/rethinkdb --daemon --config-file /etc/rethinkdb/instances.d/db-2.conf --pid-file /var/run/rethinkdb/instances.d/db-2.pid\r\n15736 ?        S      0:00 /usr/bin/rethinkdb --daemon --config-file /etc/rethinkdb/instances.d/db-2.conf --pid-file /var/run/rethinkdb/instances.d/db-2.pid\r\n27288 pts/0    S+     0:00 grep --color=auto rethinkdb\r\n```\r\n\r\nThe machines are all 4 cores. \r\n\r\nAlso when I rebooted db-1 it gave a similar error to db-6 upon starting up on the 20th of September:\r\n```\r\n2014-09-20T19:36:35.094465347 0.243604s info: Running rethinkdb 1.14.1-0ubuntu1~trusty (GCC 4.8.2)...\r\n2014-09-20T19:36:35.100808267 0.249948s info: Running on Linux 3.13.0-24-generic x86_64\r\n2014-09-20T19:36:35.100926910 0.250065s info: Using cache size of 2818 MB\r\n2014-09-20T19:36:35.102425472 0.251564s info: Loading data from directory /var/lib/rethinkdb/instances.d/db-1\r\n2014-09-20T19:36:35.748161836 0.897301s info: Listening for intracluster connections on port 29015\r\n2014-09-20T19:36:35.748469132 0.897610s info: Attempting connection to 0 peers...\r\n2014-09-20T19:36:35.961056911 1.110196s info: Listening for client driver connections on port 28015\r\n2014-09-20T19:36:35.961646701 1.110785s info: Listening for administrative HTTP connections on port 8080\r\n2014-09-20T19:36:36.981977851 2.131114s info: Listening on addresses: 127.0.0.1, 127.0.1.1, 10.128.131.104, 107.170.29.164, ::1, fe80::601:27ff:fe0a:ce01%2, fe80::601:27ff:fe0a:ce02%3\r\n2014-09-20T19:36:36.982005698 2.131142s info: Server ready\r\n2014-09-20T19:37:19.329565744 44.478704s info: Connected to server \"db_6_0_6_4_towerstorm_com_q00\" 2f04e33e-f734-426d-8c8e-e5fbdb2c20bb\r\n2014-09-20T19:37:35.506656187 60.655794s info: Disconnected from server \"db_6_0_6_4_towerstorm_com_q00\" 2f04e33e-f734-426d-8c8e-e5fbdb2c20bb\r\n2014-09-20T19:37:38.988029218 64.137168s error: Error in src/protob/protob.cc at line 299:\r\n2014-09-20T19:37:38.988153433 64.137292s error: Guarantee failed: [client_magic_number != -1]\r\n2014-09-20T19:37:38.988195379 64.137334s error: Backtrace:\r\n2014-09-20T19:37:44.915452201 70.064591s error: Error in src/protob/protob.cc at line 299:\r\n2014-09-20T19:37:44.915750045 70.064890s error: Guarantee failed: [client_magic_number != -1]\r\n2014-09-20T19:37:44.915807982 70.064946s error: Backtrace:\r\n2014-09-20T19:37:54.918905971 80.068045s error: Error in src/protob/protob.cc at line 299:\r\n2014-09-20T19:37:54.919086601 80.068225s error: Guarantee failed: [client_magic_number != -1]\r\n2014-09-20T19:37:54.919131591 80.068270s error: Backtrace:\r\n2014-09-20T19:37:55.322203451 80.471343s error: Sat Sep 20 19:37:54 2014\\n\\n1: backtrace_t::backtrace_t() at 0xaeb9a0 (/usr/bin/rethinkdb)\\n2: format_backtrace(bool) at 0xaebd33 (/usr/bin/rethinkdb)\\n3: report_fatal_error(char const*, int, char const*, ...) at 0xcc4fc5 (/usr/bin/rethinkdb)\\n4: query_server_t::handle_conn(scoped_ptr_t<linux_tcp_conn_descriptor_t> const&, auto_drainer_t::lock_t) at 0xae47c8 (/usr/bin/rethinkdb)\\n5: std::_Function_handler<void (scoped_ptr_t<linux_tcp_conn_descriptor_t>&), std::_Bind<std::_Mem_fn<void (query_server_t::*)(scoped_ptr_t<linux_tcp_conn_descriptor_t> const&, auto_drainer_t::lock_t)> (query_server_t*, std::_Placeholder<1>, auto_drainer_t::lock_t)> >::_M_invoke(std::_Any_data const&, scoped_ptr_t<linux_tcp_conn_descriptor_t>&) at 0xae5fa5 (/usr/bin/rethinkdb)\\n6: linux_nonthrowing_tcp_listener_t::handle(int) at 0xa199ac (/usr/bin/rethinkdb)\\n7: coro_t::run() at 0xa2f108 (/usr/bin/rethinkdb)\r\n2014-09-20T19:37:55.322543894 80.471682s error: Exiting.\r\n```\r\n\r\nHowever after both db-1 and db-6 failed to start I removed them from the cluster and upon starting db-1 and db-6 today without them being part of the cluster they start up fine:\r\n\r\n```\r\n2014-09-24T13:40:10.261513878 0.240764s info: Running rethinkdb 1.14.1-0ubuntu1~trusty (GCC 4.8.2)...\r\n2014-09-24T13:40:10.265265171 0.244517s info: Running on Linux 3.13.0-24-generic x86_64\r\n2014-09-24T13:40:10.265323872 0.244575s info: Using cache size of 2943 MB\r\n2014-09-24T13:40:10.266624937 0.245877s info: Loading data from directory /var/lib/rethinkdb/instances.d/db-1\r\n2014-09-24T13:40:10.880938380 0.860190s info: Listening for intracluster connections on port 29015\r\n2014-09-24T13:40:10.881112565 0.860364s warn: Attempted to join self, peer ignored\r\n2014-09-24T13:40:10.881192798 0.860445s info: Attempting connection to 0 peers...\r\n2014-09-24T13:40:11.092954191 1.072207s info: Listening for client driver connections on port 28015\r\n2014-09-24T13:40:11.093582702 1.072835s info: Listening for administrative HTTP connections on port 8080\r\n2014-09-24T13:40:12.136221160 2.115473s info: Listening on addresses: 127.0.0.1, 127.0.1.1, 10.128.131.104, 107.170.29.164, ::1, fe80::601:27ff:fe0a:ce01%2, fe80::601:27ff:fe0a:ce02%3\r\n2014-09-24T13:40:12.136260683 2.115512s info: Server ready\r\n```\r\n\r\nThey are being told to join db-1 so after booting db-1 and db-6 again they have formed their own cluster separate from the main one. \r\n\r\nlet me know if you want any more information to help disagnose the issue. \r\n"
  , issueCommentId = 56621888
  }