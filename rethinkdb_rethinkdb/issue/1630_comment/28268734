IssueComment
  { issueCommentUpdatedAt = 2013 (-11) (-12) 05 : 10 : 18 UTC
  , issueCommentUser =
      SimpleUser
        { simpleUserId = Id 548140
        , simpleUserLogin = N "karlgrz"
        , simpleUserAvatarUrl =
            "https://avatars.githubusercontent.com/u/548140?v=3"
        , simpleUserUrl = "https://api.github.com/users/karlgrz"
        , simpleUserType = OwnerUser
        }
  , issueCommentUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/comments/28268734"
  , issueCommentHtmlUrl =
      "https://github.com/rethinkdb/rethinkdb/issues/1630#issuecomment-28268734"
  , issueCommentCreatedAt = 2013 (-11) (-12) 05 : 10 : 18 UTC
  , issueCommentBody =
      "Ok, bit more info. \r\n\r\nIf rethinkdb service is running at all when I try to execute salt:\r\n\r\n```\r\nsalt-call --local state.highstate\r\n```\r\n\r\nI get similar output:\r\n\r\n```\r\n[CRITICAL] Failed to load grains defined in grain file core.os_data in function <function os_data at 0x1bff2a8>, error:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/salt/loader.py\", line 929, in gen_grains\r\n    ret = fun()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/grains/core.py\", line 881, in os_data\r\n    grains.update(_linux_gpu_data())\r\n  File \"/usr/lib/python2.7/dist-packages/salt/grains/core.py\", line 158, in _linux_gpu_data\r\n    lspci_out = __salt__['cmd.run']('lspci -vmm')\r\n  File \"/usr/lib/python2.7/dist-packages/salt/modules/cmdmod.py\", line 414, in _run_quiet\r\n    saltenv=saltenv)['stdout']\r\n  File \"/usr/lib/python2.7/dist-packages/salt/modules/cmdmod.py\", line 354, in _run\r\n    raise CommandExecutionError('Unable to run command: {0}'.format(exc))\r\nCommandExecutionError: Unable to run command: [Errno 12] Cannot allocate memory\r\n[CRITICAL] Failed to load grains defined in grain file core.ip6 in function <function ip6 at 0x2aa8c80>, error:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/salt/loader.py\", line 929, in gen_grains\r\n    ret = fun()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/grains/core.py\", line 1034, in ip6\r\n    return {'ipv6': salt.utils.network.ip_addrs6(include_loopback=True)}\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 550, in ip_addrs6\r\n    ifaces = interfaces()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 424, in interfaces\r\n    return linux_interfaces()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 304, in linux_interfaces\r\n    stderr=subprocess.STDOUT).communicate()[0]\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 709, in __init__\r\n    errread, errwrite)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 1222, in _execute_child\r\n    self.pid = os.fork()\r\nOSError: [Errno 12] Cannot allocate memory\r\n[CRITICAL] Failed to load grains defined in grain file core.ip4 in function <function ip4 at 0x2aa8b90>, error:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/salt/loader.py\", line 929, in gen_grains\r\n    ret = fun()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/grains/core.py\", line 1015, in ip4\r\n    return {'ipv4': salt.utils.network.ip_addrs(include_loopback=True)}\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 519, in ip_addrs\r\n    ifaces = interfaces()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 424, in interfaces\r\n    return linux_interfaces()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 304, in linux_interfaces\r\n    stderr=subprocess.STDOUT).communicate()[0]\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 709, in __init__\r\n    errread, errwrite)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 1222, in _execute_child\r\n    self.pid = os.fork()\r\nOSError: [Errno 12] Cannot allocate memory\r\n[CRITICAL] Failed to load grains defined in grain file core.ip_interfaces in function <function ip_interfaces at 0x2aa8d70>, error:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/dist-packages/salt/loader.py\", line 929, in gen_grains\r\n    ret = fun()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/grains/core.py\", line 1056, in ip_interfaces\r\n    ifaces = salt.utils.network.interfaces()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 424, in interfaces\r\n    return linux_interfaces()\r\n  File \"/usr/lib/python2.7/dist-packages/salt/utils/network.py\", line 304, in linux_interfaces\r\n    stderr=subprocess.STDOUT).communicate()[0]\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 709, in __init__\r\n    errread, errwrite)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 1222, in _execute_child\r\n    self.pid = os.fork()\r\nOSError: [Errno 12] Cannot allocate memory\r\n```\r\n\r\nIf I try numerous times I get the same result.\r\n\r\nWhen I stop rethinkdb service:\r\n\r\n```\r\nservice rethinkdb stop\r\n```\r\n\r\nI can then successfully execute the salt states to completion. Interestingly, when I have the rethinkdb state activated (which I would think would start the service), the salt logs show that it is in the expected state (and running) but when I check:\r\n\r\n```\r\nps aux | grep rethinkdb\r\n```\r\n\r\nIt does not show up."
  , issueCommentId = 28268734
  }