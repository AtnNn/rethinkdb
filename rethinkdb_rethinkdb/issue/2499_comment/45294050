IssueComment
  { issueCommentUpdatedAt = 2014 (-06) (-06) 01 : 21 : 56 UTC
  , issueCommentUser =
      SimpleUser
        { simpleUserId = Id 505365
        , simpleUserLogin = N "danielmewes"
        , simpleUserAvatarUrl =
            "https://avatars.githubusercontent.com/u/505365?v=3"
        , simpleUserUrl = "https://api.github.com/users/danielmewes"
        , simpleUserType = OwnerUser
        }
  , issueCommentUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/comments/45294050"
  , issueCommentHtmlUrl =
      "https://github.com/rethinkdb/rethinkdb/issues/2499#issuecomment-45294050"
  , issueCommentCreatedAt = 2014 (-06) (-06) 01 : 21 : 56 UTC
  , issueCommentBody =
      "Related Valgrind output:\r\n```\r\n==12777== Thread 3:\r\n==12777== Invalid read of size 8\r\n==12777==    at 0x173BE2A: std::_Rb_tree<key_range_t, std::pair<key_range_t const, uuid_u>, std::_Select1st<std::pair<key_range_t const, uuid_u> >, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >::_M_begin() const (stl_tree.h:498)\r\n==12777==    by 0x18876AF: std::_Rb_tree<key_range_t, std::pair<key_range_t const, uuid_u>, std::_Select1st<std::pair<key_range_t const, uuid_u> >, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >::find(key_range_t const&) const (stl_tree.h:1549)\r\n==12777==    by 0x1883EBC: std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >::find(key_range_t const&) const (stl_map.h:757)\r\n==12777==    by 0x1869FAE: void cluster_namespace_interface_t::dispatch_immediate_op<read_t, fifo_enforcer_sink_t::exit_read_t, read_response_t>(void (master_access_t::*)(fifo_enforcer_sink_t::exit_read_t*), void (master_access_t::*)(read_t const&, read_response_t*, order_token_t, fifo_enforcer_sink_t::exit_read_t*, signal_t*), read_t const&, read_response_t*, order_token_t, signal_t*) (namespace_interface.cc:119)\r\n==12777==    by 0x1866D8E: cluster_namespace_interface_t::read(read_t const&, read_response_t*, order_token_t, signal_t*) (namespace_interface.cc:40)\r\n==12777==    by 0x1B92EA1: wait_for_rdb_table_readiness(base_namespace_repo_t*, uuid_u, signal_t*, boost::shared_ptr<semilattice_readwrite_view_t<cluster_semilattice_metadata_t> >) (wait_for_readiness.cc:68)\r\n==12777==    by 0x19F35B0: ql::table_create_term_t::write_eval_impl(ql::scope_env_t*, ql::eval_flags_t) (db_table.cc:259)\r\n==12777==    by 0x19EF3AA: ql::meta_write_op_t::eval_impl(ql::scope_env_t*, ql::eval_flags_t) (db_table.cc:93)\r\n==12777==    by 0x1BB5931: ql::op_term_t::term_eval(ql::scope_env_t*, ql::eval_flags_t) (op.cc:234)\r\n==12777==    by 0x195923A: ql::term_t::eval(ql::scope_env_t*, ql::eval_flags_t) (term.cc:377)\r\n==12777==    by 0x1957B11: ql::run(ql::protob_t<Query>, rdb_context_t*, signal_t*, ql::stream_cache_t*, Response*) (term.cc:238)\r\n==12777==    by 0x1B5C613: rdb_query_server_t::run_query(ql::protob_t<Query> const&, Response*, client_context_t*) (query_server.cc:65)\r\n==12777==  Address 0x1b8f4560 is 64 bytes inside a block of size 96 free'd\r\n==12777==    at 0x4C2A4BC: operator delete(void*) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\r\n==12777==    by 0x173B3BF: __gnu_cxx::new_allocator<std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::deallocate(std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >*, unsigned long) (new_allocator.h:98)\r\n==12777==    by 0x173B391: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::_M_put_node(std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >*) (stl_tree.h:373)\r\n==12777==    by 0x173B328: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::_M_destroy_node(std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >*) (stl_tree.h:420)\r\n==12777==    by 0x173B29A: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::_M_erase(std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >*) (stl_tree.h:1076)\r\n==12777==    by 0x173B27D: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::_M_erase(std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >*) (stl_tree.h:1074)\r\n==12777==    by 0x173B27D: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::_M_erase(std::_Rb_tree_node<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >*) (stl_tree.h:1074)\r\n==12777==    by 0x1744814: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::clear() (stl_tree.h:809)\r\n==12777==    by 0x174472A: std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::operator=(std::_Rb_tree<uuid_u, std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > >, std::_Select1st<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > > const&) (stl_tree.h:941)\r\n==12777==    by 0x17446EE: std::map<uuid_u, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > >::operator=(std::map<uuid_u, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > > const&) (stl_map.h:255)\r\n==12777==    by 0x172C0B8: namespace_repo_t::on_namespaces_change()::per_thread_copyer_t::copy(std::map<uuid_u, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > > const&, one_per_thread_t<std::map<uuid_u, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > >, std::less<uuid_u>, std::allocator<std::pair<uuid_u const, std::map<key_range_t, uuid_u, std::less<key_range_t>, std::allocator<std::pair<key_range_t const, uuid_u> > > > > > >*, int, auto_drainer_t::lock_t) (namespace_interface_repository.cc:160)\r\n==12777==    by 0x173A7D0: _ZNSt5_BindIFPFvRKSt3mapI6uuid_uS0_I11key_range_tS1_St4lessIS2_ESaISt4pairIKS2_S1_EEES3_IS1_ESaIS5_IKS1_S9_EEEP16one_per_thread_tISE_EiN14auto_drainer_t6lock_tEESE_SJ_iSL_EE6__callIvJEJLi0ELi1ELi2ELi3EEEET_OSt5tupleIJDpT0_EESt12_Index_tupleIJXspT1_EEE (functional:1145)\r\n==12777== \r\n```\r\n\r\nand many more like that."
  , issueCommentId = 45294050
  }