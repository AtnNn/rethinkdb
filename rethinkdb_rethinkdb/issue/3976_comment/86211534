IssueComment
  { issueCommentUpdatedAt = 2015 (-03) (-25) 21 : 11 : 25 UTC
  , issueCommentUser =
      SimpleUser
        { simpleUserId = Id 44855
        , simpleUserLogin = N "chrisvariety"
        , simpleUserAvatarUrl =
            "https://avatars.githubusercontent.com/u/44855?v=3"
        , simpleUserUrl = "https://api.github.com/users/chrisvariety"
        , simpleUserType = OwnerUser
        }
  , issueCommentUrl =
      "https://api.github.com/repos/rethinkdb/rethinkdb/issues/comments/86211534"
  , issueCommentHtmlUrl =
      "https://github.com/rethinkdb/rethinkdb/issues/3976#issuecomment-86211534"
  , issueCommentCreatedAt = 2015 (-03) (-25) 20 : 50 : 19 UTC
  , issueCommentBody =
      "Just ran into this myself, it didn't happen as part of an upgrade though.\r\n\r\nI was playing around creating and deleting the same secondary index via the Web UI. I had just deleted the secondary index, then re-created it w/ slightly different definition. I went to query it (again via Web UI) and it said the index hadn't finished construction yet. So I tried the query again and the server crashed. There were no other queries running on the server.\r\n\r\nNow whenever I try to access that index, the server crashes, so totally 100% reproducible with my data set when running a certain query, I assume the index is caught in some bad state?  Maybe it wasn't fully deleted yet when I went to re-create it?\r\n\r\nHappy to send my data directory to someone if you like!\r\n\r\nHere's my backtrace if it is helpful:\r\n\r\n```\r\nRunning rethinkdb 1.16.2-1 (CLANG 4.2 (clang-425.0.28))...\r\nRunning on Darwin 14.1.0 x86_64\r\nLoading data from directory /Users/chrismcc/workspace/ti/rethinkdb_data\r\nListening for intracluster connections on port 29015\r\nListening for client driver connections on port 28015\r\nListening for administrative HTTP connections on port 8080\r\nListening on addresses: 127.0.0.1, ::1\r\nTo fully expose RethinkDB on the network, bind to all addresses by running rethinkdb with the `--bind all` command line option.\r\nServer ready, \"goldie_local_syz\" 828ee31e-e0aa-4f93-aa1c-1612310a3e3b\r\nVersion: rethinkdb 1.16.2-1 (CLANG 4.2 (clang-425.0.28))\r\nerror: Error in src/rdb_protocol/protocol.cc at line 737:\r\nerror: Guarantee failed: [out->skey_version == resp->skey_version] \r\nerror: Backtrace:\r\nerror: Wed Mar 25 20:42:44 2015\r\n       \r\n       1: 0   rethinkdb                           0x000000010852d6fb _Z11deserializeIL17cluster_version_t4EE16archive_result_tP13read_stream_tP17repli_timestamp_t + 539 at 0x10852d6fb ()\r\n       2: 0   rethinkdb                           0x00000001081328ec _ZN26callable_action_instance_tI21pmap_runner_one_arg_tINSt3__16__bindIM29traversal_progress_combiner_tFviEJPS3_RNS1_12placeholders4__phILi1EEEEEExEED0Ev + 2684 at 0x1081328ec ()\r\n       3: 0   rethinkdb                           0x0000000108133127 _ZN26callable_action_instance_tI21pmap_runner_one_arg_tINSt3__16__bindIM29traversal_progress_combiner_tFviEJPS3_RNS1_12placeholders4__phILi1EEEEEExEED0Ev + 4791 at 0x108133127 ()\r\n       4: 0   rethinkdb                           0x000000010813250a _ZN26callable_action_instance_tI21pmap_runner_one_arg_tINSt3__16__bindIM29traversal_progress_combiner_tFviEJPS3_RNS1_12placeholders4__phILi1EEEEEExEED0Ev + 1690 at 0x10813250a ()\r\n       5: 0   rethinkdb                           0x000000010832faec _Z11deserializeIL17cluster_version_t4EE16archive_result_tP13read_stream_tP13name_string_t + 8268 at 0x10832faec ()\r\n       6: 0   rethinkdb                           0x0000000108444b1a _ZN23rdb_r_unshard_visitor_t19unshard_range_batchI20rget_read_response_t11rget_read_tEEvRKT0_9sorting_t + 874 at 0x108444b1a ()\r\n       7: 0   rethinkdb                           0x0000000108440439 _ZN5boost6detail7variant13forced_returnIPKN7profile6stop_tEEET_v + 16345 at 0x108440439 ()\r\n       8: 0   rethinkdb                           0x00000001082ebe78 _ZN29cluster_namespace_interface_t21dispatch_immediate_opI6read_tN20fifo_enforcer_sink_t11exit_read_tE15read_response_tEEvM15master_access_tFvPT0_EMS5_FvRKT_PT1_13order_token_tS7_P8signal_tESC_SE_SF_SH_ + 1928 at 0x1082ebe78 ()\r\n       9: 0   rethinkdb                           0x00000001082e83ff _ZNK5boost6detail7variant9known_getIKN29reactor_business_card_details19primary_when_safe_tEEclIKNS3_9primary_tEEERS5_RT_ + 2927 at 0x1082e83ff ()\r\n       10: 0   rethinkdb                           0x0000000108493b0f _ZNSt3__16__treeINS_4pairIPcP5cJSONEENS_19__map_value_compareIS2_S4_N14query_language21char_star_cmp_functorELb1EEENS_9allocatorIS5_EEE7destroyEPNS_11__tree_nodeIS5_PvEE + 2143 at 0x108493b0f ()\r\n       11: 0   rethinkdb                           0x00000001083c6ba7 _ZNK2ql18datum_rcheckable_t12runtime_failENS_10base_exc_t6type_tEPKcS4_iNSt3__112basic_stringIcNS5_11char_traitsIcEENS5_9allocatorIcEEEE + 1799 at 0x1083c6ba7 ()\r\n       12: 0   rethinkdb                           0x00000001083c7b7b _ZNK2ql18datum_rcheckable_t12runtime_failENS_10base_exc_t6type_tEPKcS4_iNSt3__112basic_stringIcNS5_11char_traitsIcEENS5_9allocatorIcEEEE + 5851 at 0x1083c7b7b ()\r\n       13: 0   rethinkdb                           0x00000001083c853b _ZNK2ql18datum_rcheckable_t12runtime_failENS_10base_exc_t6type_tEPKcS4_iNSt3__112basic_stringIcNS5_11char_traitsIcEENS5_9allocatorIcEEEE + 8347 at 0x1083c853b ()\r\n       14: 0   rethinkdb                           0x00000001083c6f16 _ZNK2ql18datum_rcheckable_t12runtime_failENS_10base_exc_t6type_tEPKcS4_iNSt3__112basic_stringIcNS5_11char_traitsIcEENS5_9allocatorIcEEEE + 2678 at 0x1083c6f16 ()\r\n       15: 0   rethinkdb                           0x00000001083cdb5a _ZNK2ql18datum_rcheckable_t12runtime_failENS_10base_exc_t6type_tEPKcS4_iNSt3__112basic_stringIcNS5_11char_traitsIcEENS5_9allocatorIcEEEE + 30394 at 0x1083cdb5a ()\r\n       16: 0   rethinkdb                           0x00000001083cca22 _ZNK2ql18datum_rcheckable_t12runtime_failENS_10base_exc_t6type_tEPKcS4_iNSt3__112basic_stringIcNS5_11char_traitsIcEENS5_9allocatorIcEEEE + 25986 at 0x1083cca22 ()\r\n       17: 0   rethinkdb                           0x00000001084ba89a _ZN16backfill_chunk_t8sindexesERKNSt3__13mapINS0_12basic_stringIcNS0_11char_traitsIcEENS0_9allocatorIcEEEE17secondary_index_tNS0_4lessIS7_EENS5_INS0_4pairIKS7_S8_EEEEEE + 1626 at 0x1084ba89a ()\r\n       18: 0   rethinkdb                           0x00000001084bfc67 _ZN2ql11deserializeIL17cluster_version_t4EEE16archive_result_tP13read_stream_tPNS_5sym_tE + 18279 at 0x1084bfc67 ()\r\n       19: 0   rethinkdb                           0x00000001084920de _ZN5boost9gregorian4dateC2ENS0_9greg_yearENS0_10greg_monthENS0_8greg_dayE + 3470 at 0x1084920de ()\r\n       20: 0   rethinkdb                           0x000000010835b7e3 _ZNSt3__16__treeINS_4pairINS_12basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEEiEENS_19__map_value_compareIS7_iNS_4lessIS7_EELb1EEENS5_IS8_EEE7destroyEPNS_11__tree_nodeIS8_PvEE + 9203 at 0x10835b7e3 ()\r\n       21: 0   rethinkdb                           0x0000000108351a7e _ZNKSt3__16__treeINS_12basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEENS_4lessIS6_EENS4_IS6_EEE13__lower_boundIS6_EENS_21__tree_const_iteratorIS6_PKNS_11__tree_nodeIS6_PvEElEERKT_SH_SH_ + 1278 at 0x108351a7e ()\r\n       22: 0   rethinkdb                           0x0000000108351a7e _ZNKSt3__16__treeINS_12basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEENS_4lessIS6_EENS4_IS6_EEE13__lower_boundIS6_EENS_21__tree_const_iteratorIS6_PKNS_11__tree_nodeIS6_PvEElEERKT_SH_SH_ + 1278 at 0x108351a7e ()\r\n       23: 0   rethinkdb                           0x0000000108346307 _ZNSt3__16__treeINS_4pairINS_12basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEEEKS7_EENS_19__map_value_compareIS7_S8_NS_4lessIS7_EELb1EEENS5_IS9_EEE13__lower_boundIS7_EENS_15__tree_iteratorIS9_PNS_11__tree_nodeIS9_PvEElEERKT_SL_SL_ + 12551 at 0x108346307 ()\r\n       24: 0   rethinkdb                           0x0000000108348df0 _ZN5boost3_bi5list3INS0_5valueIP13http_server_tEENS_3argILi1EEENS2_IN14auto_drainer_t6lock_tEEEEclINS_4_mfi3mf2IvS3_RK12scoped_ptr_tI27linux_tcp_conn_descriptor_tES9_EENS0_5list1IRSH_EEEEvNS0_4typeIvEERT_RT0_i + 80 at 0x108348df0 ()\r\n       25: 0   rethinkdb                           0x0000000108348d60 _ZNSt3__110__function6__funcIN5boost3_bi6bind_tIvNS2_4_mfi3mf2Iv13http_server_tRK12scoped_ptr_tI27linux_tcp_conn_descriptor_tEN14auto_drainer_t6lock_tEEENS3_5list3INS3_5valueIPS7_EENS2_3argILi1EEENSH_ISE_EEEEEENS_9allocatorISO_EEFvRSA_EEclESR_ + 32 at 0x108348d60 ()\r\n       26: 0   rethinkdb                           0x0000000108121d16 _ZN8signal_tD2Ev + 25046 at 0x108121d16 ()\r\n       27: 0   rethinkdb                           0x0000000108128258 _ZN22threaded_context_ref_tC2Ev + 1304 at 0x108128258 ()\r\nerror: Exiting.\r\nTrace/BPT trap: 5\r\n```"
  , issueCommentId = 86211534
  }